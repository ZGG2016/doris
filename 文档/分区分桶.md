# 分区分桶

[TOC]

## 1 分区

### Range分区

#### 单列分区

```sql
CREATE TABLE IF NOT EXISTS example_range_tbl
(
    `user_id` LARGEINT NOT NULL COMMENT "用户id",
    `date` DATE NOT NULL COMMENT "数据灌入日期时间",
    `timestamp` DATETIME NOT NULL COMMENT "数据灌入的时间戳",
    `city` VARCHAR(20) COMMENT "用户所在城市",
    `age` SMALLINT COMMENT "用户年龄",
    `sex` TINYINT COMMENT "用户性别",
    `last_visit_date` DATETIME REPLACE DEFAULT "1970-01-01 00:00:00" COMMENT "用户最后一次访问时间",
    `cost` BIGINT SUM DEFAULT "0" COMMENT "用户总消费",
    `max_dwell_time` INT MAX DEFAULT "0" COMMENT "用户最大停留时间",
    `min_dwell_time` INT MIN DEFAULT "99999" COMMENT "用户最小停留时间"
)
engine=olap
AGGREGATE KEY(`user_id`, `date`, `timestamp`, `city`, `age`, `sex`)
partition by range(`date`)
(
    partition `p201701` values less than ("2017-02-01"),
    partition `p201702` values less than ("2017-03-01"),
    partition `p201703` values less than ("2017-04-01")
)
DISTRIBUTED BY HASH(`user_id`) BUCKETS 16
PROPERTIES (
"replication_allocation" = "tag.location.default: 1",
"storage_cooldown_time" = "2024-01-01 12:00:00"
);


insert into example_range_tbl values
(200,"2017-01-01","2017-01-01 08:00:05","北京",20,0,"2017-01-01 06:00:00",20,10,10),
(2000,"2017-01-01","2017-01-01 09:00:05","北京",20,0,"2017-01-01 07:00:00",15,2,2),
(100,"2017-02-01","2017-02-01 18:12:10","北京",30,1,"2017-02-01 17:05:45",2,22,22),
(2000,"2017-02-01","2017-02-01 13:10:00","上海",20,1,"2017-02-01 12:59:12",200,5,5),
(5000,"2017-02-15","2017-02-15 13:15:00","广州",32,0,"2017-02-15 11:20:00",30,11,11),
(2000,"2017-03-01","2017-03-01 12:12:48","深圳",35,0,"2017-03-01 10:00:15",100,3,3),
(1,"2017-03-10","2017-03-10 12:38:20","深圳",35,0,"2017-03-10 10:20:22",11,6,6);

mysql> show partitions from example_range_tbl;
+-------------+---------------+----------------+---------------------+--------+--------------+--------------------------------------------------------------------------------+-----------------+---------+----------------+---------------+---------------------+---------------------+--------------------------+----------+------------+-------------------------+-----------+
| PartitionId | PartitionName | VisibleVersion | VisibleVersionTime  | State  | PartitionKey | Range                                                                          | DistributionKey | Buckets | ReplicationNum | StorageMedium | CooldownTime        | RemoteStoragePolicy | LastConsistencyCheckTime | DataSize | IsInMemory | ReplicaAllocation       | IsMutable |
+-------------+---------------+----------------+---------------------+--------+--------------+--------------------------------------------------------------------------------+-----------------+---------+----------------+---------------+---------------------+---------------------+--------------------------+----------+------------+-------------------------+-----------+
| 12254       | p201701       | 2              | 2023-08-18 13:00:55 | NORMAL | date         | [types: [DATEV2]; keys: [0000-01-01]; ..types: [DATEV2]; keys: [2017-02-01]; ) | user_id         | 16      | 1              | HDD           | 9999-12-31 15:59:59 |                     | NULL                     | 3.200 KB | false      | tag.location.default: 1 | true      |
| 12255       | p201702       | 2              | 2023-08-18 13:00:55 | NORMAL | date         | [types: [DATEV2]; keys: [2017-02-01]; ..types: [DATEV2]; keys: [2017-03-01]; ) | user_id         | 16      | 1              | HDD           | 9999-12-31 15:59:59 |                     | NULL                     | 4.824 KB | false      | tag.location.default: 1 | true      |
| 12256       | p201703       | 2              | 2023-08-18 13:00:55 | NORMAL | date         | [types: [DATEV2]; keys: [2017-03-01]; ..types: [DATEV2]; keys: [2017-04-01]; ) | user_id         | 16      | 1              | HDD           | 9999-12-31 15:59:59 |                     | NULL                     | 3.196 KB | false      | tag.location.default: 1 | true      |
+-------------+---------------+----------------+---------------------+--------+--------------+--------------------------------------------------------------------------------+-----------------+---------+----------------+---------------+---------------------+---------------------+--------------------------+----------+------------+-------------------------+-----------+
3 rows in set (0.04 sec)

-- 分区 p201701
mysql> select * from example_range_tbl partition p201701;       
+---------+------------+---------------------+--------+------+------+---------------------+------+----------------+----------------+
| user_id | date       | timestamp           | city   | age  | sex  | last_visit_date     | cost | max_dwell_time | min_dwell_time |
+---------+------------+---------------------+--------+------+------+---------------------+------+----------------+----------------+
| 2000    | 2017-01-01 | 2017-01-01 09:00:05 | 北京   |   20 |    0 | 2017-01-01 07:00:00 |   15 |              2 |              2 |
| 200     | 2017-01-01 | 2017-01-01 08:00:05 | 北京   |   20 |    0 | 2017-01-01 06:00:00 |   20 |             10 |             10 |
+---------+------------+---------------------+--------+------+------+---------------------+------+----------------+----------------+
2 rows in set (0.10 sec)

-- 分区 p201702
mysql> select * from example_range_tbl partition p201702;
+---------+------------+---------------------+--------+------+------+---------------------+------+----------------+----------------+
| user_id | date       | timestamp           | city   | age  | sex  | last_visit_date     | cost | max_dwell_time | min_dwell_time |
+---------+------------+---------------------+--------+------+------+---------------------+------+----------------+----------------+
| 5000    | 2017-02-15 | 2017-02-15 13:15:00 | 广州   |   32 |    0 | 2017-02-15 11:20:00 |   30 |             11 |             11 |
| 2000    | 2017-02-01 | 2017-02-01 13:10:00 | 上海   |   20 |    1 | 2017-02-01 12:59:12 |  200 |              5 |              5 |
| 100     | 2017-02-01 | 2017-02-01 18:12:10 | 北京   |   30 |    1 | 2017-02-01 17:05:45 |    2 |             22 |             22 |
+---------+------------+---------------------+--------+------+------+---------------------+------+----------------+----------------+
3 rows in set (0.11 sec)

-- 分区 p201703
mysql> select * from example_range_tbl partition p201703;
+---------+------------+---------------------+--------+------+------+---------------------+------+----------------+----------------+
| user_id | date       | timestamp           | city   | age  | sex  | last_visit_date     | cost | max_dwell_time | min_dwell_time |
+---------+------------+---------------------+--------+------+------+---------------------+------+----------------+----------------+
| 1       | 2017-03-10 | 2017-03-10 12:38:20 | 深圳   |   35 |    0 | 2017-03-10 10:20:22 |   11 |              6 |              6 |
| 2000    | 2017-03-01 | 2017-03-01 12:12:48 | 深圳   |   35 |    0 | 2017-03-01 10:00:15 |  100 |              3 |              3 |
+---------+------------+---------------------+--------+------+------+---------------------+------+----------------+----------------+
2 rows in set (0.19 sec)

-- 新增一个分区 p201705
alter table example_range_tbl add partition p201705 values less than ("2017-06-01");

mysql> show partitions from example_range_tbl;
+-------------+---------------+----------------+---------------------+--------+--------------+--------------------------------------------------------------------------------+-----------------+---------+----------------+---------------+---------------------+---------------------+--------------------------+----------+------------+-------------------------+-----------+
| PartitionId | PartitionName | VisibleVersion | VisibleVersionTime  | State  | PartitionKey | Range                                                                          | DistributionKey | Buckets | ReplicationNum | StorageMedium | CooldownTime        | RemoteStoragePolicy | LastConsistencyCheckTime | DataSize | IsInMemory | ReplicaAllocation       | IsMutable |
+-------------+---------------+----------------+---------------------+--------+--------------+--------------------------------------------------------------------------------+-----------------+---------+----------------+---------------+---------------------+---------------------+--------------------------+----------+------------+-------------------------+-----------+
| 12254       | p201701       | 2              | 2023-08-18 13:00:55 | NORMAL | date         | [types: [DATEV2]; keys: [0000-01-01]; ..types: [DATEV2]; keys: [2017-02-01]; ) | user_id         | 16      | 1              | HDD           | 9999-12-31 15:59:59 |                     | NULL                     | 3.200 KB | false      | tag.location.default: 1 | true      |
| 12255       | p201702       | 2              | 2023-08-18 13:00:55 | NORMAL | date         | [types: [DATEV2]; keys: [2017-02-01]; ..types: [DATEV2]; keys: [2017-03-01]; ) | user_id         | 16      | 1              | HDD           | 9999-12-31 15:59:59 |                     | NULL                     | 4.824 KB | false      | tag.location.default: 1 | true      |
| 12256       | p201703       | 2              | 2023-08-18 13:00:55 | NORMAL | date         | [types: [DATEV2]; keys: [2017-03-01]; ..types: [DATEV2]; keys: [2017-04-01]; ) | user_id         | 16      | 1              | HDD           | 9999-12-31 15:59:59 |                     | NULL                     | 3.196 KB | false      | tag.location.default: 1 | true      |
| 12356       | p201705       | 1              | 2023-08-18 13:12:12 | NORMAL | date         | [types: [DATEV2]; keys: [2017-04-01]; ..types: [DATEV2]; keys: [2017-06-01]; ) | user_id         | 16      | 1              | HDD           | 9999-12-31 15:59:59 |                     | NULL                     | 0.000    | false      | tag.location.default: 1 | true      |
+-------------+---------------+----------------+---------------------+--------+--------------+--------------------------------------------------------------------------------+-----------------+---------+----------------+---------------+---------------------+---------------------+--------------------------+----------+------------+-------------------------+-----------+
4 rows in set (0.01 sec)

-- 删除一个分区 p201703
alter table example_range_tbl drop partition p201703;

mysql> show partitions from example_range_tbl;
+-------------+---------------+----------------+---------------------+--------+--------------+--------------------------------------------------------------------------------+-----------------+---------+----------------+---------------+---------------------+---------------------+--------------------------+----------+------------+-------------------------+-----------+
| PartitionId | PartitionName | VisibleVersion | VisibleVersionTime  | State  | PartitionKey | Range                                                                          | DistributionKey | Buckets | ReplicationNum | StorageMedium | CooldownTime        | RemoteStoragePolicy | LastConsistencyCheckTime | DataSize | IsInMemory | ReplicaAllocation       | IsMutable |
+-------------+---------------+----------------+---------------------+--------+--------------+--------------------------------------------------------------------------------+-----------------+---------+----------------+---------------+---------------------+---------------------+--------------------------+----------+------------+-------------------------+-----------+
| 12254       | p201701       | 2              | 2023-08-18 13:00:55 | NORMAL | date         | [types: [DATEV2]; keys: [0000-01-01]; ..types: [DATEV2]; keys: [2017-02-01]; ) | user_id         | 16      | 1              | HDD           | 9999-12-31 15:59:59 |                     | NULL                     | 3.200 KB | false      | tag.location.default: 1 | true      |
| 12255       | p201702       | 2              | 2023-08-18 13:00:55 | NORMAL | date         | [types: [DATEV2]; keys: [2017-02-01]; ..types: [DATEV2]; keys: [2017-03-01]; ) | user_id         | 16      | 1              | HDD           | 9999-12-31 15:59:59 |                     | NULL                     | 4.824 KB | false      | tag.location.default: 1 | true      |
| 12356       | p201705       | 1              | 2023-08-18 13:12:12 | NORMAL | date         | [types: [DATEV2]; keys: [2017-04-01]; ..types: [DATEV2]; keys: [2017-06-01]; ) | user_id         | 16      | 1              | HDD           | 9999-12-31 15:59:59 |                     | NULL                     | 0.000    | false      | tag.location.default: 1 | true      |
+-------------+---------------+----------------+---------------------+--------+--------------+--------------------------------------------------------------------------------+-----------------+---------+----------------+---------------+---------------------+---------------------+--------------------------+----------+------------+-------------------------+-----------+
3 rows in set (0.01 sec)

mysql> select count(1) from example_range_tbl; 
+----------+
| count(1) |
+----------+
|        5 |
+----------+

-- 尝试往 p201703 导入一条数据
mysql> insert into example_range_tbl values (210,"2017-03-18","2017-03-18 08:00:05","北京",20,0,"2017-03-18 16:00:00",20,10,10);
ERROR 5025 (HY000): Insert has filtered data in strict mode, tracking_url=http://192.168.31.246:8040/api/_load_error_log?file=__shard_3/error_log_insert_stmt_55482865b4b649e0-a00b36b5a66fcdf5_55482865b4b649e0_a00b36b5a66fcdf5

-- 查看上述链接内容
Reason: no partition for this tuple. tuple=+---------------+---------------+---------------+------------------+-----------------+----------------+----------------------+-----------------+-----------------+-----------------+
|(Int128)       |(DateV2)       |(DateTimeV2)   |(Nullable(String))|(Nullable(Int16))|(Nullable(Int8))|(Nullable(DateTimeV2))|(Nullable(Int64))|(Nullable(Int32))|(Nullable(Int32))|
+---------------+---------------+---------------+------------------+-----------------+----------------+----------------------+-----------------+-----------------+-----------------+
|            210|     2017-03-18|2017-03-18 0...|            北京|               20|               0|   2017-03-18 16:00:00|               20|               10|               10|
+---------------+---------------+---------------+------------------+-----------------+----------------+----------------------+-----------------+-----------------+-----------------+
. src line []; 


-- 删除一个分区 p201702
alter table example_range_tbl drop partition p201702;

mysql> show partitions from example_range_tbl;
+-------------+---------------+----------------+---------------------+--------+--------------+--------------------------------------------------------------------------------+-----------------+---------+----------------+---------------+---------------------+---------------------+--------------------------+----------+------------+-------------------------+-----------+
| PartitionId | PartitionName | VisibleVersion | VisibleVersionTime  | State  | PartitionKey | Range                                                                          | DistributionKey | Buckets | ReplicationNum | StorageMedium | CooldownTime        | RemoteStoragePolicy | LastConsistencyCheckTime | DataSize | IsInMemory | ReplicaAllocation       | IsMutable |
+-------------+---------------+----------------+---------------------+--------+--------------+--------------------------------------------------------------------------------+-----------------+---------+----------------+---------------+---------------------+---------------------+--------------------------+----------+------------+-------------------------+-----------+
| 12254       | p201701       | 2              | 2023-08-18 13:00:55 | NORMAL | date         | [types: [DATEV2]; keys: [0000-01-01]; ..types: [DATEV2]; keys: [2017-02-01]; ) | user_id         | 16      | 1              | HDD           | 9999-12-31 15:59:59 |                     | NULL                     | 3.200 KB | false      | tag.location.default: 1 | true      |
| 12356       | p201705       | 5              | 2023-08-18 13:20:35 | NORMAL | date         | [types: [DATEV2]; keys: [2017-04-01]; ..types: [DATEV2]; keys: [2017-06-01]; ) | user_id         | 16      | 1              | HDD           | 9999-12-31 15:59:59 |                     | NULL                     | 3.180 KB | false      | tag.location.default: 1 | true      |
+-------------+---------------+----------------+---------------------+--------+--------------+--------------------------------------------------------------------------------+-----------------+---------+----------------+---------------+---------------------+---------------------+--------------------------+----------+------------+-------------------------+-----------+
2 rows in set (0.00 sec)


-- 新增一个分区 p201702new
alter table example_range_tbl add partition p201702new values less than ("2017-03-01");

mysql> show partitions from example_range_tbl;
+-------------+---------------+----------------+---------------------+--------+--------------+--------------------------------------------------------------------------------+-----------------+---------+----------------+---------------+---------------------+---------------------+--------------------------+----------+------------+-------------------------+-----------+
| PartitionId | PartitionName | VisibleVersion | VisibleVersionTime  | State  | PartitionKey | Range                                                                          | DistributionKey | Buckets | ReplicationNum | StorageMedium | CooldownTime        | RemoteStoragePolicy | LastConsistencyCheckTime | DataSize | IsInMemory | ReplicaAllocation       | IsMutable |
+-------------+---------------+----------------+---------------------+--------+--------------+--------------------------------------------------------------------------------+-----------------+---------+----------------+---------------+---------------------+---------------------+--------------------------+----------+------------+-------------------------+-----------+
| 12254       | p201701       | 2              | 2023-08-18 13:00:55 | NORMAL | date         | [types: [DATEV2]; keys: [0000-01-01]; ..types: [DATEV2]; keys: [2017-02-01]; ) | user_id         | 16      | 1              | HDD           | 9999-12-31 15:59:59 |                     | NULL                     | 3.200 KB | false      | tag.location.default: 1 | true      |
| 12393       | p201702new    | 1              | 2023-08-18 13:23:33 | NORMAL | date         | [types: [DATEV2]; keys: [2017-02-01]; ..types: [DATEV2]; keys: [2017-03-01]; ) | user_id         | 16      | 1              | HDD           | 9999-12-31 15:59:59 |                     | NULL                     | 0.000    | false      | tag.location.default: 1 | true      |
| 12356       | p201705       | 5              | 2023-08-18 13:20:35 | NORMAL | date         | [types: [DATEV2]; keys: [2017-04-01]; ..types: [DATEV2]; keys: [2017-06-01]; ) | user_id         | 16      | 1              | HDD           | 9999-12-31 15:59:59 |                     | NULL                     | 3.180 KB | false      | tag.location.default: 1 | true      |
+-------------+---------------+----------------+---------------------+--------+--------------+--------------------------------------------------------------------------------+-----------------+---------+----------------+---------------+---------------------+---------------------+--------------------------+----------+------------+-------------------------+-----------+
3 rows in set (0.00 sec)

-- 删除一个分区 p201701  新增一个分区 p201612
alter table example_range_tbl drop partition p201701;
alter table example_range_tbl add partition p201612 values less than ("2017-01-01");

mysql> show partitions from example_range_tbl;
+-------------+---------------+----------------+---------------------+--------+--------------+--------------------------------------------------------------------------------+-----------------+---------+----------------+---------------+---------------------+---------------------+--------------------------+----------+------------+-------------------------+-----------+
| PartitionId | PartitionName | VisibleVersion | VisibleVersionTime  | State  | PartitionKey | Range                                                                          | DistributionKey | Buckets | ReplicationNum | StorageMedium | CooldownTime        | RemoteStoragePolicy | LastConsistencyCheckTime | DataSize | IsInMemory | ReplicaAllocation       | IsMutable |
+-------------+---------------+----------------+---------------------+--------+--------------+--------------------------------------------------------------------------------+-----------------+---------+----------------+---------------+---------------------+---------------------+--------------------------+----------+------------+-------------------------+-----------+
| 12426       | p201612       | 1              | 2023-08-18 13:24:49 | NORMAL | date         | [types: [DATEV2]; keys: [0000-01-01]; ..types: [DATEV2]; keys: [2017-01-01]; ) | user_id         | 16      | 1              | HDD           | 9999-12-31 15:59:59 |                     | NULL                     | 0.000    | false      | tag.location.default: 1 | true      |
| 12393       | p201702new    | 1              | 2023-08-18 13:23:33 | NORMAL | date         | [types: [DATEV2]; keys: [2017-02-01]; ..types: [DATEV2]; keys: [2017-03-01]; ) | user_id         | 16      | 1              | HDD           | 9999-12-31 15:59:59 |                     | NULL                     | 0.000    | false      | tag.location.default: 1 | true      |
| 12356       | p201705       | 5              | 2023-08-18 13:20:35 | NORMAL | date         | [types: [DATEV2]; keys: [2017-04-01]; ..types: [DATEV2]; keys: [2017-06-01]; ) | user_id         | 16      | 1              | HDD           | 9999-12-31 15:59:59 |                     | NULL                     | 3.180 KB | false      | tag.location.default: 1 | true      |
+-------------+---------------+----------------+---------------------+--------+--------------+--------------------------------------------------------------------------------+-----------------+---------+----------------+---------------+---------------------+---------------------+--------------------------+----------+------------+-------------------------+-----------+
3 rows in set (0.01 sec)
```

#### 多列分区

```sql
CREATE TABLE IF NOT EXISTS example_range_tbl2
(
    `user_id` LARGEINT NOT NULL COMMENT "用户id",
    `date` DATE NOT NULL COMMENT "数据灌入日期时间",
    `timestamp` DATETIME NOT NULL COMMENT "数据灌入的时间戳",
    `city` VARCHAR(20) COMMENT "用户所在城市",
    `age` SMALLINT COMMENT "用户年龄",
    `sex` TINYINT COMMENT "用户性别",
    `last_visit_date` DATETIME REPLACE DEFAULT "1970-01-01 00:00:00" COMMENT "用户最后一次访问时间",
    `cost` BIGINT SUM DEFAULT "0" COMMENT "用户总消费",
    `max_dwell_time` INT MAX DEFAULT "0" COMMENT "用户最大停留时间",
    `min_dwell_time` INT MIN DEFAULT "99999" COMMENT "用户最小停留时间"
)
engine=olap
AGGREGATE KEY(`user_id`, `date`, `timestamp`, `city`, `age`, `sex`)
partition by range(`date`, `user_id`)
(
    partition `p201701_1000` values less than ("2017-02-01", "1000"),
    partition `p201702_2000` values less than ("2017-03-01","2000"),
    partition `p201703_all` values less than ("2017-04-01")
)
DISTRIBUTED BY HASH(`user_id`) BUCKETS 16
PROPERTIES (
"replication_allocation" = "tag.location.default: 1",
"storage_cooldown_time" = "2024-01-01 12:00:00"
);


insert into example_range_tbl2 values
(200,"2017-01-01","2017-01-01 08:00:05","北京",20,0,"2017-01-01 06:00:00",20,10,10),
(2000,"2017-01-01","2017-01-01 09:00:05","北京",20,0,"2017-01-01 07:00:00",15,2,2),
(100,"2017-02-01","2017-02-01 18:12:10","北京",30,1,"2017-02-01 17:05:45",2,22,22),
(2000,"2017-02-01","2017-02-01 13:10:00","上海",20,1,"2017-02-01 12:59:12",200,5,5),
(5000,"2017-02-15","2017-02-15 13:15:00","广州",32,0,"2017-02-15 11:20:00",30,11,11),
(2000,"2017-03-01","2017-03-01 12:12:48","深圳",35,0,"2017-03-01 10:00:15",100,3,3),
(1,"2017-03-10","2017-03-10 12:38:20","深圳",35,0,"2017-03-10 10:20:22",11,6,6),
(1500,"2017-03-01","2017-03-01 08:00:05","北京",20,0,"2017-03-01 16:00:00",20,10,10);

-- 注意 "2017-02-01 100" 这行数据
-- 它属于分区p201701_1000，因为第一个字段不满足条件，但第二个字段满足条件。
-- 或者说，这两个字段都比较后，如果都不满足条件，才属于p201702_2000
mysql> select `date`, `user_id` from example_range_tbl2 partition p201701_1000;
+------------+---------+
| date       | user_id |
+------------+---------+
| 2017-01-01 | 200     |
| 2017-02-01 | 100     |
| 2017-01-01 | 2000    |
+------------+---------+
3 rows in set (0.67 sec)

-- 注意 "2017-03-01 1500" 这行数据
mysql> select `date`, `user_id` from example_range_tbl2 partition p201702_2000;
+------------+---------+
| date       | user_id |
+------------+---------+
| 2017-02-15 | 5000    |
| 2017-02-01 | 2000    |
| 2017-03-01 | 1500    |
+------------+---------+
3 rows in set (0.16 sec)

mysql> select `date`, `user_id` from example_range_tbl2 partition p201703_all;
+------------+---------+
| date       | user_id |
+------------+---------+
| 2017-03-10 | 1       |
| 2017-03-01 | 2000    |
+------------+---------+

```

#### 批量分区

```sql
-- 按天批量创建分区
CREATE TABLE IF NOT EXISTS example_range_tbl3
(
    `user_id` LARGEINT NOT NULL COMMENT "用户id",
    `date` DATE NOT NULL COMMENT "数据灌入日期时间",
    `timestamp` DATETIME NOT NULL COMMENT "数据灌入的时间戳",
    `city` VARCHAR(20) COMMENT "用户所在城市",
    `age` SMALLINT COMMENT "用户年龄",
    `sex` TINYINT COMMENT "用户性别",
    `last_visit_date` DATETIME REPLACE DEFAULT "1970-01-01 00:00:00" COMMENT "用户最后一次访问时间",
    `cost` BIGINT SUM DEFAULT "0" COMMENT "用户总消费",
    `max_dwell_time` INT MAX DEFAULT "0" COMMENT "用户最大停留时间",
    `min_dwell_time` INT MIN DEFAULT "99999" COMMENT "用户最小停留时间"
)
engine=olap
AGGREGATE KEY(`user_id`, `date`, `timestamp`, `city`, `age`, `sex`)
partition by range(`date`)
(
    from ("2017-01-01") to ("2017-01-04") interval 1 day
)
DISTRIBUTED BY HASH(`user_id`) BUCKETS 16
PROPERTIES (
"replication_allocation" = "tag.location.default: 1",
"storage_cooldown_time" = "2024-01-01 12:00:00"
);


insert into example_range_tbl3 values
(200,"2017-01-01","2017-01-01 08:00:05","北京",20,0,"2017-01-01 06:00:00",20,10,10),
(2000,"2017-01-02","2017-01-02 09:00:05","北京",20,0,"2017-01-01 07:00:00",15,2,2),
(100,"2017-01-03","2017-01-03 18:12:10","北京",30,1,"2017-01-03 17:05:45",2,22,22),
(2000,"2017-01-03","2017-01-04 13:10:00","上海",20,1,"2017-01-04 12:59:12",200,5,5);


-- 注意，不包含2017-01-04
mysql> show partitions from example_range_tbl3;
+-------------+---------------+----------------+---------------------+--------+--------------+--------------------------------------------------------------------------------+-----------------+---------+----------------+---------------+---------------------+---------------------+--------------------------+----------+------------+-------------------------+-----------+
| PartitionId | PartitionName | VisibleVersion | VisibleVersionTime  | State  | PartitionKey | Range                                                                          | DistributionKey | Buckets | ReplicationNum | StorageMedium | CooldownTime        | RemoteStoragePolicy | LastConsistencyCheckTime | DataSize | IsInMemory | ReplicaAllocation       | IsMutable |
+-------------+---------------+----------------+---------------------+--------+--------------+--------------------------------------------------------------------------------+-----------------+---------+----------------+---------------+---------------------+---------------------+--------------------------+----------+------------+-------------------------+-----------+
| 12562       | p20170101     | 2              | 2023-08-18 13:41:30 | NORMAL | date         | [types: [DATEV2]; keys: [2017-01-01]; ..types: [DATEV2]; keys: [2017-01-02]; ) | user_id         | 16      | 1              | HDD           | 9999-12-31 15:59:59 |                     | NULL                     | 0.000    | false      | tag.location.default: 1 | true      |
| 12563       | p20170102     | 2              | 2023-08-18 13:41:30 | NORMAL | date         | [types: [DATEV2]; keys: [2017-01-02]; ..types: [DATEV2]; keys: [2017-01-03]; ) | user_id         | 16      | 1              | HDD           | 9999-12-31 15:59:59 |                     | NULL                     | 0.000    | false      | tag.location.default: 1 | true      |
| 12564       | p20170103     | 2              | 2023-08-18 13:41:30 | NORMAL | date         | [types: [DATEV2]; keys: [2017-01-03]; ..types: [DATEV2]; keys: [2017-01-04]; ) | user_id         | 16      | 1              | HDD           | 9999-12-31 15:59:59 |                     | NULL                     | 0.000    | false      | tag.location.default: 1 | true      |
+-------------+---------------+----------------+---------------------+--------+--------------+--------------------------------------------------------------------------------+-----------------+---------+----------------+---------------+---------------------+---------------------+--------------------------+----------+------------+-------------------------+-----------+
3 rows in set (0.01 sec)

mysql> select `date`, `user_id` from example_range_tbl3 partition p20170101;
+------------+---------+
| date       | user_id |
+------------+---------+
| 2017-01-01 | 200     |
+------------+---------+
1 row in set (0.05 sec)

mysql> select `date`, `user_id` from example_range_tbl3 partition p20170102;
+------------+---------+
| date       | user_id |
+------------+---------+
| 2017-01-02 | 2000    |
+------------+---------+
1 row in set (0.03 sec)

mysql> select `date`, `user_id` from example_range_tbl3 partition p20170103;
+------------+---------+
| date       | user_id |
+------------+---------+
| 2017-01-03 | 100     |
| 2017-01-03 | 2000    |
+------------+---------+
2 rows in set (0.07 sec)
```

### List分区

#### 单列分区

```sql
CREATE TABLE IF NOT EXISTS example_list_tbl
(
    `user_id` LARGEINT NOT NULL COMMENT "用户id",
    `date` DATE NOT NULL COMMENT "数据灌入日期时间",
    `timestamp` DATETIME NOT NULL COMMENT "数据灌入的时间戳",
    `city` VARCHAR(20) NOT NULL COMMENT "用户所在城市",
    `age` SMALLINT COMMENT "用户年龄",
    `sex` TINYINT COMMENT "用户性别",
    `last_visit_date` DATETIME REPLACE DEFAULT "1970-01-01 00:00:00" COMMENT "用户最后一次访问时间",
    `cost` BIGINT SUM DEFAULT "0" COMMENT "用户总消费",
    `max_dwell_time` INT MAX DEFAULT "0" COMMENT "用户最大停留时间",
    `min_dwell_time` INT MIN DEFAULT "99999" COMMENT "用户最小停留时间"
)
ENGINE=olap
AGGREGATE KEY(`user_id`, `date`, `timestamp`, `city`, `age`, `sex`)
PARTITION BY LIST(`city`)
(
    PARTITION `p_cn` VALUES IN ("Beijing", "Shanghai", "Hong Kong"),
    PARTITION `p_usa` VALUES IN ("New York", "San Francisco"),
    PARTITION `p_jp` VALUES IN ("Tokyo")
)
DISTRIBUTED BY HASH(`user_id`) BUCKETS 16
PROPERTIES
(
    "replication_allocation" = "tag.location.default: 1",
    "storage_cooldown_time" = "2024-01-01 12:00:00"
);

insert into example_list_tbl values
(200,"2017-01-01","2017-01-01 08:00:05","Beijing",20,0,"2017-01-01 06:00:00",20,10,10),
(2000,"2017-01-01","2017-01-01 09:00:05","Beijing",20,0,"2017-01-01 07:00:00",15,2,2),
(100,"2017-02-01","2017-02-01 18:12:10","Tokyo",30,1,"2017-02-01 17:05:45",2,22,22),
(2000,"2017-02-01","2017-02-01 13:10:00","Shanghai",20,1,"2017-02-01 12:59:12",200,5,5),
(5000,"2017-02-15","2017-02-15 13:15:00","Hong Kong",32,0,"2017-02-15 11:20:00",30,11,11),
(2000,"2017-03-01","2017-03-01 12:12:48","New York",35,0,"2017-03-01 10:00:15",100,3,3),
(1,"2017-03-10","2017-03-10 12:38:20","San Francisco",35,0,"2017-03-10 10:20:22",11,6,6);
(1,"2017-03-10","2017-03-10 12:38:20","San Francisco",35,0,"2017-03-10 10:20:22",11,6,6);


mysql> show partitions from example_list_tbl;
+-------------+---------------+----------------+---------------------+--------+--------------+--------------------------------------------------------------------------------------------------------------------+-----------------+---------+----------------+---------------+---------------------+---------------------+--------------------------+----------+------------+-------------------------+-----------+
| PartitionId | PartitionName | VisibleVersion | VisibleVersionTime  | State  | PartitionKey | Range                                                                                                              | DistributionKey | Buckets | ReplicationNum | StorageMedium | CooldownTime        | RemoteStoragePolicy | LastConsistencyCheckTime | DataSize | IsInMemory | ReplicaAllocation       | IsMutable |
+-------------+---------------+----------------+---------------------+--------+--------------+--------------------------------------------------------------------------------------------------------------------+-----------------+---------+----------------+---------------+---------------------+---------------------+--------------------------+----------+------------+-------------------------+-----------+
| 12153       | p_cn          | 1              | 2023-08-18 12:21:13 | NORMAL | city         | [types: [VARCHAR]; keys: [Beijing]; , types: [VARCHAR]; keys: [Shanghai]; , types: [VARCHAR]; keys: [Hong Kong]; ] | user_id         | 16      | 1              | HDD           | 9999-12-31 15:59:59 |                     | NULL                     | 0.000    | false      | tag.location.default: 1 | true      |
| 12154       | p_usa         | 1              | 2023-08-18 12:21:13 | NORMAL | city         | [types: [VARCHAR]; keys: [New York]; , types: [VARCHAR]; keys: [San Francisco]; ]                                  | user_id         | 16      | 1              | HDD           | 9999-12-31 15:59:59 |                     | NULL                     | 0.000    | false      | tag.location.default: 1 | true      |
| 12155       | p_jp          | 1              | 2023-08-18 12:21:13 | NORMAL | city         | [types: [VARCHAR]; keys: [Tokyo]; ]                                                                                | user_id         | 16      | 1              | HDD           | 9999-12-31 15:59:59 |                     | NULL                     | 0.000    | false      | tag.location.default: 1 | true      |
+-------------+---------------+----------------+---------------------+--------+--------------+--------------------------------------------------------------------------------------------------------------------+-----------------+---------+----------------+---------------+---------------------+---------------------+--------------------------+----------+------------+-------------------------+-----------+
3 rows in set (0.06 sec)


-- 增加一个分区 p_uk 
mysql> alter table example_list_tbl add partition p_uk values in ("London");
Query OK, 0 rows affected (0.07 sec)

mysql> show partitions from example_list_tbl;
+-------------+---------------+----------------+---------------------+--------+--------------+--------------------------------------------------------------------------------------------------------------------+-----------------+---------+----------------+---------------+---------------------+---------------------+--------------------------+----------+------------+-------------------------+-----------+
| PartitionId | PartitionName | VisibleVersion | VisibleVersionTime  | State  | PartitionKey | Range                                                                                                              | DistributionKey | Buckets | ReplicationNum | StorageMedium | CooldownTime        | RemoteStoragePolicy | LastConsistencyCheckTime | DataSize | IsInMemory | ReplicaAllocation       | IsMutable |
+-------------+---------------+----------------+---------------------+--------+--------------+--------------------------------------------------------------------------------------------------------------------+-----------------+---------+----------------+---------------+---------------------+---------------------+--------------------------+----------+------------+-------------------------+-----------+
| 12153       | p_cn          | 1              | 2023-08-18 12:21:13 | NORMAL | city         | [types: [VARCHAR]; keys: [Beijing]; , types: [VARCHAR]; keys: [Shanghai]; , types: [VARCHAR]; keys: [Hong Kong]; ] | user_id         | 16      | 1              | HDD           | 9999-12-31 15:59:59 |                     | NULL                     | 0.000    | false      | tag.location.default: 1 | true      |
| 13003       | p_uk          | 1              | 2023-08-21 11:53:04 | NORMAL | city         | [types: [VARCHAR]; keys: [London]; ]                                                                               | user_id         | 16      | 1              | HDD           | 9999-12-31 15:59:59 |                     | NULL                     | 0.000    | false      | tag.location.default: 1 | true      |
| 12154       | p_usa         | 1              | 2023-08-18 12:21:13 | NORMAL | city         | [types: [VARCHAR]; keys: [New York]; , types: [VARCHAR]; keys: [San Francisco]; ]                                  | user_id         | 16      | 1              | HDD           | 9999-12-31 15:59:59 |                     | NULL                     | 0.000    | false      | tag.location.default: 1 | true      |
| 12155       | p_jp          | 1              | 2023-08-18 12:21:13 | NORMAL | city         | [types: [VARCHAR]; keys: [Tokyo]; ]                                                                                | user_id         | 16      | 1              | HDD           | 9999-12-31 15:59:59 |                     | NULL                     | 0.000    | false      | tag.location.default: 1 | true      |
+-------------+---------------+----------------+---------------------+--------+--------------+--------------------------------------------------------------------------------------------------------------------+-----------------+---------+----------------+---------------+---------------------+---------------------+--------------------------+----------+------------+-------------------------+-----------+
4 rows in set (0.00 sec)


-- 删除分区 p_jp
mysql> alter table example_list_tbl drop partition p_jp;
Query OK, 0 rows affected (0.01 sec)

mysql> show partitions from example_list_tbl;
+-------------+---------------+----------------+---------------------+--------+--------------+--------------------------------------------------------------------------------------------------------------------+-----------------+---------+----------------+---------------+---------------------+---------------------+--------------------------+----------+------------+-------------------------+-----------+
| PartitionId | PartitionName | VisibleVersion | VisibleVersionTime  | State  | PartitionKey | Range                                                                                                              | DistributionKey | Buckets | ReplicationNum | StorageMedium | CooldownTime        | RemoteStoragePolicy | LastConsistencyCheckTime | DataSize | IsInMemory | ReplicaAllocation       | IsMutable |
+-------------+---------------+----------------+---------------------+--------+--------------+--------------------------------------------------------------------------------------------------------------------+-----------------+---------+----------------+---------------+---------------------+---------------------+--------------------------+----------+------------+-------------------------+-----------+
| 12153       | p_cn          | 1              | 2023-08-18 12:21:13 | NORMAL | city         | [types: [VARCHAR]; keys: [Beijing]; , types: [VARCHAR]; keys: [Shanghai]; , types: [VARCHAR]; keys: [Hong Kong]; ] | user_id         | 16      | 1              | HDD           | 9999-12-31 15:59:59 |                     | NULL                     | 0.000    | false      | tag.location.default: 1 | true      |
| 13003       | p_uk          | 1              | 2023-08-21 11:53:04 | NORMAL | city         | [types: [VARCHAR]; keys: [London]; ]                                                                               | user_id         | 16      | 1              | HDD           | 9999-12-31 15:59:59 |                     | NULL                     | 0.000    | false      | tag.location.default: 1 | true      |
| 12154       | p_usa         | 1              | 2023-08-18 12:21:13 | NORMAL | city         | [types: [VARCHAR]; keys: [New York]; , types: [VARCHAR]; keys: [San Francisco]; ]                                  | user_id         | 16      | 1              | HDD           | 9999-12-31 15:59:59 |                     | NULL                     | 0.000    | false      | tag.location.default: 1 | true      |
+-------------+---------------+----------------+---------------------+--------+--------------+--------------------------------------------------------------------------------------------------------------------+-----------------+---------+----------------+---------------+---------------------+---------------------+--------------------------+----------+------------+-------------------------+-----------+
3 rows in set (0.01 sec)

```

#### 多列分区

```sql
CREATE TABLE IF NOT EXISTS example_list_tbl2
(
    `user_id` LARGEINT NOT NULL COMMENT "用户id",
    `date` DATE NOT NULL COMMENT "数据灌入日期时间",
    `timestamp` DATETIME NOT NULL COMMENT "数据灌入的时间戳",
    `city` VARCHAR(20) NOT NULL COMMENT "用户所在城市",
    `age` SMALLINT COMMENT "用户年龄",
    `sex` TINYINT COMMENT "用户性别",
    `last_visit_date` DATETIME REPLACE DEFAULT "1970-01-01 00:00:00" COMMENT "用户最后一次访问时间",
    `cost` BIGINT SUM DEFAULT "0" COMMENT "用户总消费",
    `max_dwell_time` INT MAX DEFAULT "0" COMMENT "用户最大停留时间",
    `min_dwell_time` INT MIN DEFAULT "99999" COMMENT "用户最小停留时间"
)
ENGINE=olap
AGGREGATE KEY(`user_id`, `date`, `timestamp`, `city`, `age`, `sex`)
PARTITION BY LIST(`user_id`, `city`)
(
    PARTITION `p1_city` VALUES IN (("1", "Beijing"), ("1", "Shanghai")),
    PARTITION `p2_city` VALUES IN (("2", "Beijing"), ("2", "Shanghai")),
    PARTITION `p3_city` VALUES IN (("3", "Beijing"), ("3", "Shanghai"))
)
DISTRIBUTED BY HASH(`user_id`) BUCKETS 16
PROPERTIES
(
    "replication_allocation" = "tag.location.default: 1",
    "storage_cooldown_time" = "2024-01-01 12:00:00"
);

mysql> insert into example_list_tbl2 values
    -> (1,"2017-01-01","2017-01-01 08:00:05","Beijing",20,0,"2017-01-01 06:00:00",20,10,10),
    -> (1,"2017-01-01","2017-01-01 09:00:05","Shanghai",20,0,"2017-01-01 07:00:00",15,2,2),
    -> (2,"2017-02-01","2017-02-01 18:12:10","Shanghai",30,1,"2017-02-01 17:05:45",2,22,22),
    -> (3,"2017-02-01","2017-02-01 13:10:00","Beijing",20,1,"2017-02-01 12:59:12",200,5,5),
    -> (1,"2017-02-15","2017-02-15 13:15:00","Tianjin",32,0,"2017-02-15 11:20:00",30,11,11),
    -> (4,"2017-03-01","2017-03-01 12:12:48","Beijing",35,0,"2017-03-01 10:00:15",100,3,3);
ERROR 5025 (HY000): Insert has filtered data in strict mode, tracking_url=http://192.168.31.246:8040/api/_load_error_log?file=__shard_0/error_log_insert_stmt_cc0284f4060c4dca-985f6125a2c57e1b_cc0284f4060c4dca_985f6125a2c57e1b

-- 上述网址内容
Reason: no partition for this tuple. tuple=+---------------+---------------+---------------+---------------+-----------------+----------------+----------------------+-----------------+-----------------+-----------------+
|(Int128)       |(DateV2)       |(DateTimeV2)   |(String)       |(Nullable(Int16))|(Nullable(Int8))|(Nullable(DateTimeV2))|(Nullable(Int64))|(Nullable(Int32))|(Nullable(Int32))|
+---------------+---------------+---------------+---------------+-----------------+----------------+----------------------+-----------------+-----------------+-----------------+
|              1|     2017-02-15|2017-02-15 1...|        Tianjin|               32|               0|   2017-02-15 11:20:00|               30|               11|               11|
+---------------+---------------+---------------+---------------+-----------------+----------------+----------------------+-----------------+-----------------+-----------------+
6 rows in block, only show first 1 rows.
. src line []; 
Reason: no partition for this tuple. tuple=+---------------+---------------+---------------+---------------+-----------------+----------------+----------------------+-----------------+-----------------+-----------------+
|(Int128)       |(DateV2)       |(DateTimeV2)   |(String)       |(Nullable(Int16))|(Nullable(Int8))|(Nullable(DateTimeV2))|(Nullable(Int64))|(Nullable(Int32))|(Nullable(Int32))|
+---------------+---------------+---------------+---------------+-----------------+----------------+----------------------+-----------------+-----------------+-----------------+
|              4|     2017-03-01|2017-03-01 1...|        Beijing|               35|               0|   2017-03-01 10:00:15|              100|                3|                3|
+---------------+---------------+---------------+---------------+-----------------+----------------+----------------------+-----------------+-----------------+-----------------+
6 rows in block, only show first 1 rows.
. src line []; 


insert into example_list_tbl2 values
(1,"2017-01-01","2017-01-01 08:00:05","Beijing",20,0,"2017-01-01 06:00:00",20,10,10),
(1,"2017-01-01","2017-01-01 09:00:05","Shanghai",20,0,"2017-01-01 07:00:00",15,2,2),
(2,"2017-02-01","2017-02-01 18:12:10","Shanghai",30,1,"2017-02-01 17:05:45",2,22,22),
(3,"2017-02-01","2017-02-01 13:10:00","Beijing",20,1,"2017-02-01 12:59:12",200,5,5);

mysql> select * from example_list_tbl2 partition p1_city;
+---------+------------+---------------------+----------+------+------+---------------------+------+----------------+----------------+
| user_id | date       | timestamp           | city     | age  | sex  | last_visit_date     | cost | max_dwell_time | min_dwell_time |
+---------+------------+---------------------+----------+------+------+---------------------+------+----------------+----------------+
| 1       | 2017-01-01 | 2017-01-01 08:00:05 | Beijing  |   20 |    0 | 2017-01-01 06:00:00 |   20 |             10 |             10 |
| 1       | 2017-01-01 | 2017-01-01 09:00:05 | Shanghai |   20 |    0 | 2017-01-01 07:00:00 |   15 |              2 |              2 |
+---------+------------+---------------------+----------+------+------+---------------------+------+----------------+----------------+
2 rows in set (0.09 sec)

mysql> select * from example_list_tbl2 partition p2_city;  
+---------+------------+---------------------+----------+------+------+---------------------+------+----------------+----------------+
| user_id | date       | timestamp           | city     | age  | sex  | last_visit_date     | cost | max_dwell_time | min_dwell_time |
+---------+------------+---------------------+----------+------+------+---------------------+------+----------------+----------------+
| 2       | 2017-02-01 | 2017-02-01 18:12:10 | Shanghai |   30 |    1 | 2017-02-01 17:05:45 |    2 |             22 |             22 |
+---------+------------+---------------------+----------+------+------+---------------------+------+----------------+----------------+
1 row in set (0.07 sec)

mysql> select * from example_list_tbl2 partition p3_city; 
+---------+------------+---------------------+---------+------+------+---------------------+------+----------------+----------------+
| user_id | date       | timestamp           | city    | age  | sex  | last_visit_date     | cost | max_dwell_time | min_dwell_time |
+---------+------------+---------------------+---------+------+------+---------------------+------+----------------+----------------+
| 3       | 2017-02-01 | 2017-02-01 13:10:00 | Beijing |   20 |    1 | 2017-02-01 12:59:12 |  200 |              5 |              5 |
+---------+------------+---------------------+---------+------+------+---------------------+------+----------------+----------------+
1 row in set (0.16 sec)
```

## 2 分桶

```sql
-- 列出指定table的所有tablets（仅管理员使用）
mysql> show tablets from example_range_tbl partitions(p201705);
+----------+-----------+-----------+------------+---------+-------------------+------------------+---------------+---------------+----------------+----------+--------+-------------------------+--------------+--------------+-----------+---------------------+--------------------------------------------------+----------------------------------------------------------------+-------------------+----------------+
| TabletId | ReplicaId | BackendId | SchemaHash | Version | LstSuccessVersion | LstFailedVersion | LstFailedTime | LocalDataSize | RemoteDataSize | RowCount | State  | LstConsistencyCheckTime | CheckVersion | VersionCount | QueryHits | PathHash            | MetaUrl                                          | CompactionStatus                                               | CooldownReplicaId | CooldownMetaId |
+----------+-----------+-----------+------------+---------+-------------------+------------------+---------------+---------------+----------------+----------+--------+-------------------------+--------------+--------------+-----------+---------------------+--------------------------------------------------+----------------------------------------------------------------+-------------------+----------------+
| 12357    | 12358     | 10146     | 1266371294 | 5       | 5                 | -1               | NULL          | 0             | 0              | 0        | NORMAL | NULL                    | -1           | 3            | 0         | 3943849327900090759 | http://192.168.31.246:8040/api/meta/header/12357 | http://192.168.31.246:8040/api/compaction/show?tablet_id=12357 | -1                |                |
| 12359    | 12360     | 10146     | 1266371294 | 5       | 5                 | -1               | NULL          | 0             | 0              | 0        | NORMAL | NULL                    | -1           | 1            | 0         | 3943849327900090759 | http://192.168.31.246:8040/api/meta/header/12359 | http://192.168.31.246:8040/api/compaction/show?tablet_id=12359 | -1                |                |
| 12361    | 12362     | 10146     | 1266371294 | 5       | 5                 | -1               | NULL          | 0             | 0              | 0        | NORMAL | NULL                    | -1           | 1            | 0         | 3943849327900090759 | http://192.168.31.246:8040/api/meta/header/12361 | http://192.168.31.246:8040/api/compaction/show?tablet_id=12361 | -1                |                |
| 12363    | 12364     | 10146     | 1266371294 | 5       | 5                 | -1               | NULL          | 0             | 0              | 0        | NORMAL | NULL                    | -1           | 1            | 0         | 3943849327900090759 | http://192.168.31.246:8040/api/meta/header/12363 | http://192.168.31.246:8040/api/compaction/show?tablet_id=12363 | -1                |                |
| 12365    | 12366     | 10146     | 1266371294 | 5       | 5                 | -1               | NULL          | 0             | 0              | 0        | NORMAL | NULL                    | -1           | 1            | 0         | 3943849327900090759 | http://192.168.31.246:8040/api/meta/header/12365 | http://192.168.31.246:8040/api/compaction/show?tablet_id=12365 | -1                |                |
| 12367    | 12368     | 10146     | 1266371294 | 5       | 5                 | -1               | NULL          | 0             | 0              | 0        | NORMAL | NULL                    | -1           | 1            | 0         | 3943849327900090759 | http://192.168.31.246:8040/api/meta/header/12367 | http://192.168.31.246:8040/api/compaction/show?tablet_id=12367 | -1                |                |
| 12369    | 12370     | 10146     | 1266371294 | 5       | 5                 | -1               | NULL          | 3256          | 0              | 2        | NORMAL | NULL                    | -1           | 5            | 0         | 3943849327900090759 | http://192.168.31.246:8040/api/meta/header/12369 | http://192.168.31.246:8040/api/compaction/show?tablet_id=12369 | -1                |                |
| 12371    | 12372     | 10146     | 1266371294 | 5       | 5                 | -1               | NULL          | 0             | 0              | 0        | NORMAL | NULL                    | -1           | 1            | 0         | 3943849327900090759 | http://192.168.31.246:8040/api/meta/header/12371 | http://192.168.31.246:8040/api/compaction/show?tablet_id=12371 | -1                |                |
| 12373    | 12374     | 10146     | 1266371294 | 5       | 5                 | -1               | NULL          | 0             | 0              | 0        | NORMAL | NULL                    | -1           | 1            | 0         | 3943849327900090759 | http://192.168.31.246:8040/api/meta/header/12373 | http://192.168.31.246:8040/api/compaction/show?tablet_id=12373 | -1                |                |
| 12375    | 12376     | 10146     | 1266371294 | 5       | 5                 | -1               | NULL          | 0             | 0              | 0        | NORMAL | NULL                    | -1           | 1            | 0         | 3943849327900090759 | http://192.168.31.246:8040/api/meta/header/12375 | http://192.168.31.246:8040/api/compaction/show?tablet_id=12375 | -1                |                |
| 12377    | 12378     | 10146     | 1266371294 | 5       | 5                 | -1               | NULL          | 0             | 0              | 0        | NORMAL | NULL                    | -1           | 1            | 0         | 3943849327900090759 | http://192.168.31.246:8040/api/meta/header/12377 | http://192.168.31.246:8040/api/compaction/show?tablet_id=12377 | -1                |                |
| 12379    | 12380     | 10146     | 1266371294 | 5       | 5                 | -1               | NULL          | 0             | 0              | 0        | NORMAL | NULL                    | -1           | 1            | 0         | 3943849327900090759 | http://192.168.31.246:8040/api/meta/header/12379 | http://192.168.31.246:8040/api/compaction/show?tablet_id=12379 | -1                |                |
| 12381    | 12382     | 10146     | 1266371294 | 5       | 5                 | -1               | NULL          | 0             | 0              | 0        | NORMAL | NULL                    | -1           | 1            | 0         | 3943849327900090759 | http://192.168.31.246:8040/api/meta/header/12381 | http://192.168.31.246:8040/api/compaction/show?tablet_id=12381 | -1                |                |
| 12383    | 12384     | 10146     | 1266371294 | 5       | 5                 | -1               | NULL          | 0             | 0              | 0        | NORMAL | NULL                    | -1           | 1            | 0         | 3943849327900090759 | http://192.168.31.246:8040/api/meta/header/12383 | http://192.168.31.246:8040/api/compaction/show?tablet_id=12383 | -1                |                |
| 12385    | 12386     | 10146     | 1266371294 | 5       | 5                 | -1               | NULL          | 0             | 0              | 0        | NORMAL | NULL                    | -1           | 1            | 0         | 3943849327900090759 | http://192.168.31.246:8040/api/meta/header/12385 | http://192.168.31.246:8040/api/compaction/show?tablet_id=12385 | -1                |                |
| 12387    | 12388     | 10146     | 1266371294 | 5       | 5                 | -1               | NULL          | 0             | 0              | 0        | NORMAL | NULL                    | -1           | 1            | 0         | 3943849327900090759 | http://192.168.31.246:8040/api/meta/header/12387 | http://192.168.31.246:8040/api/compaction/show?tablet_id=12387 | -1                |                |
+----------+-----------+-----------+------------+---------+-------------------+------------------+---------------+---------------+----------------+----------+--------+-------------------------+--------------+--------------+-----------+---------------------+--------------------------------------------------+----------------------------------------------------------------+-------------------+----------------+
16 rows in set (0.01 sec)
```